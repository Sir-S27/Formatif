<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formatif</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
</head>

<body class="bg-gray-200">
    <div class="flex items-center justify-center mt-20">
        <div class="bg-white p-8 w-1/3 rounded-xl shadow">
            <div class="font-extrabold text-xl mb-2 text-gray-600">YOUR ORDER <span id="orderCount" class="ml-2 text-sm bg-gray-100 text-gray-700 px-2 py-0.5 rounded">1</span></div>
            <div class="flex items-center">
                <div>
                    <div class="font-bold">Cold Brew Coffee</div>
                    <div class="flex text-xs text-gray-500 font-semibold">RP 30.000 / item</div>
                </div>
                <div class="mt-4 flex items-center gap-2 ml-auto">
                    <button id="quen" class="bg-gray-400 hover:bg-gray-200 text-white px-3 py-1 rounded">-</button>
                    <div id="Nomor" class="w-12 text-center font-bold">1</div>
                    <button id="king" class="bg-gray-400 hover:bg-gray-200 text-white px-3 py-1 rounded">+</button>
                    <button id="resetBtn" class="ml-2 text-sm text-white bg-gray-400 hover:bg-gray-200 px-6 py-2 rounded ">Reset</button>
                </div>
            </div>
            <hr class="my-4">
            <div class="flex items-center justify-between">
                <div class="font-bold">Total</div>
                <div id="total" class="font-bold">RP 30.000</div>
            </div>
            <div class="font-bold text-[#595959] text-xl mt-6">PAYMENT METHODE</div>
            <hr class="border-1 mt-2" />
            <form onsubmit="handleSubmit(event)" method="post">
                <div class="mt-4">
                    <select id="paymentMethod" class="w-full border rounded-lg p-2" onchange="handlePaymentChange()">
                        <option value="">---Pilih Payment---</option>
                        <option value="gopay">Gopay</option>
                        <option value="dana">Dana</option>
                    </select>
                </div>
                <div id="paymentDetail" class="mt-6 hidden text-center">
                    <p class="text-gray-600 text-sm">Nomor Pembayaran</p>
                    <p id="paymentNumber" class="font-bold text-lg mt-1"></p>

                    <img id="paymentQr" src="" alt="Qr Code" class="w-40 h-40 mx-auto mt-4" />
                </div>
                <button type="submit" class="bg-[#2F7B5D] text-white px-8 mt-4 py-1 rounded-3xl">
                    Submit
                </button>
            </form>
        </div>
    </div>
    <div id="toast"
        class="hidden fixed bottom-6 left-1/2 transform -translate-x-1/2 z-50 px-6 py-3 rounded text-white shadow-lg transition-opacity duration-300">
    âœ… Payment berhasil!</div>

    <script>
        (function () {
            const qtyEl = document.getElementById('Nomor');
            const dec = document.getElementById('quen');
            const inc = document.getElementById('king');
            const totalEl = document.getElementById('total');
            const orderCountEl = document.getElementById('orderCount');
            let qty = 1;
            const min = 1, max = 10;
            const unitPrice = 30000;
            function formatCurrency(n) {
                return 'RP ' + n.toLocaleString('id-ID');
            }
            function update() {
                qtyEl.textContent = qty;
                dec.disabled = qty <= min;
                inc.disabled = qty >= max;
                dec.classList.toggle('opacity-50', dec.disabled);
                inc.classList.toggle('opacity-50', inc.disabled);
                const total = qty * unitPrice;
                totalEl.textContent = formatCurrency(total);
                if(orderCountEl) orderCountEl.textContent = qty;
            }
            dec.addEventListener('click', () => { if (qty > min) { qty--; update(); } });
            inc.addEventListener('click', () => { if (qty < max) { qty++; update(); } });
            update();
            window.getQuantity = function () { return qty; };
            window.setQuantity = function (v) { qty = Math.max(min, Math.min(max, Number(v) || min)); update(); };
            window.resetQuantity = function(){ qty = 0; update(); };
        })();
    </script>
    <script>
        document.getElementById('resetBtn')?.addEventListener('click', function(){
            if(window.setQuantity){
                window.setQuantity(1);
               
            }
        });
    </script>

    <script>
        function handlePaymentChange() {
            const paymentMethod = document.getElementById('paymentMethod');
            const paymentDetail = document.getElementById('paymentDetail');
            const paymentNumber = document.getElementById('paymentNumber');
            const paymentQr = document.getElementById('paymentQr');
  
            const method = paymentMethod.value;
            if (method === 'gopay') {
                paymentNumber.textContent = '12345';
                paymentQr.src = 'https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=GOPAY-081234567890';
                paymentDetail.classList.remove('hidden');
            } else if (method === 'dana') {
                paymentNumber.textContent = '67890';
                paymentQr.src = 'https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=DANA-082345678901';
                paymentDetail.classList.remove('hidden');
            } else {
                paymentDetail.classList.add('hidden');
                paymentNumber.textContent = '';
                paymentQr.src = '';
            }
        }

        document.getElementById('paymentMethod').addEventListener('change', handlePaymentChange);
    </script>

    <script>
        function showToast(message, success) {
            const toastEl = document.getElementById('toast');
            clearTimeout(window._toastTimer);
            toastEl.textContent = message;
            toastEl.className = 'fixed bottom-6 left-1/2 transform -translate-x-1/2 z-50 px-6 py-3 rounded text-white shadow-lg transition-opacity duration-300';
            toastEl.classList.add(success ? 'bg-green-600' : 'bg-red-600');
            toastEl.classList.remove('hidden');
            toastEl.style.opacity = '1';
            window._toastTimer = setTimeout(() => {
                toastEl.style.opacity = '0';
                setTimeout(() => toastEl.classList.add('hidden'), 300);
            }, 2500);
        }
    </script>

    <script>
        function handleSubmit(e) {
            e.preventDefault();
            const paymentMethod = document.getElementById('paymentMethod');
            const paymentDetail = document.getElementById('paymentDetail');
            const paymentQr = document.getElementById('paymentQr');
            const method = paymentMethod.value;
            const qrVisible = !paymentDetail.classList.contains('hidden') && paymentQr.src;
            if (!method || !qrVisible) {
                showToast('Pilih payment method dan tampilkan QR terlebih dahulu', false);
                return;
            }
            showToast('Pembayaran berhasil', true);
            paymentMethod.value = '';
            handlePaymentChange();
            if (window.setQuantity) window.setQuantity(1);
        }
    </script>
</body>

</html>
